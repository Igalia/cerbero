From cb61f8c4e5f48fd5c1ec545e8675402e9a6ed002 Mon Sep 17 00:00:00 2001
From: =?UTF-8?q?Fernando=20Jim=C3=A9nez=20Moreno?= <ferjmoreno@gmail.com>
Date: Tue, 25 May 2021 14:17:31 +0200
Subject: [PATCH] Disable PSON

---
 Source/WebKit/UIProcess/API/glib/WebKitWebContext.cpp | 5 +++--
 1 file changed, 3 insertions(+), 2 deletions(-)

diff --git a/Source/WebKit/UIProcess/API/glib/WebKitWebContext.cpp b/Source/WebKit/UIProcess/API/glib/WebKitWebContext.cpp
index 1b128a4c6825..283967ce2de6 100644
--- a/Source/WebKit/UIProcess/API/glib/WebKitWebContext.cpp
+++ b/Source/WebKit/UIProcess/API/glib/WebKitWebContext.cpp
@@ -402,9 +402,10 @@ static void webkitWebContextConstructed(GObject* object)
 
     API::ProcessPoolConfiguration configuration;
     configuration.setInjectedBundlePath(FileSystem::stringFromFileSystemRepresentation(bundleFilename.get()));
-    configuration.setUsesWebProcessCache(true);
+    configuration.setUsesWebProcessCache(false);
+    configuration.setProcessSwapsOnNavigation(false);
+    configuration.setUsesSingleWebProcess(true);
 #if PLATFORM(GTK)
-    configuration.setProcessSwapsOnNavigation(priv->psonEnabled);
 #if !USE(GTK4)
     configuration.setUseSystemAppearanceForScrollbars(priv->useSystemAppearanceForScrollbars);
 #endif
-- 
2.37.0

